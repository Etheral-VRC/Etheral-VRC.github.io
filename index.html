<!DOCTYPE html>
<html>
<head>
    <title>File Manipulation</title>
</head>
<body>
    <h1>File Manipulation</h1>

    <script>
        // Function to handle file creation and retrieval based on query parameters
        function manipulateFile() {
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get("m");
            const name = urlParams.get("name");
            const data = urlParams.get("data");

            if (mode === "1" && name && data) {
                // Mode 1: Create a file with data on the server side
                const decodedData = atob(data); // Decode base64 data
                const blob = new Blob([decodedData], { type: "text/plain" });
                const a = document.createElement("a");
                a.href = window.URL.createObjectURL(blob);
                a.download = name;
                a.textContent = "Download " + name;
                document.body.appendChild(a);
            } else if (mode === "2" && name) {
                // Mode 2: Get file from the server side and display in HTML
                fetch(name)
                    .then(response => response.text())
                    .then(text => {
                        const pre = document.createElement("pre");
                        pre.textContent = text;
                        document.body.appendChild(pre);
                    })
                    .catch(error => console.error("Error fetching file:", error));
            } else {
                console.error("Invalid query parameters.");
            }
        }

        // Call the manipulation function when the page loads
        window.addEventListener("load", manipulateFile);
    </script>
</body>
</html>
